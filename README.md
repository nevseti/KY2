<hr>

<h2>Краткое описание</h2>

<p>
    Разработан инструмент для извлечения информации о прямых зависимостях
    Rust-проекта из файла <code>Cargo.toml</code>. Программа поддерживает два режима работы:
    загрузка файла из локальной директории и загрузка по URL. Реализован
    упрощённый парсер TOML без использования сторонних библиотек, что
    позволяет корректно обрабатывать секцию <code>[dependencies]</code> и выводить список
    зависимостей на экран.
</p>

<p>
    Утилита работает через командную строку, принимает параметры для выбора
    пакета, источника данных, режима работы и имени выходного файла. На данном
    этапе графическая визуализация ещё не выполняется — основной функционал
    сосредоточен на корректной загрузке и разборе данных.
</p>

<hr>

<h2>Структура проекта</h2>

<ol>
    <li>main.py</li>
    <li>Функции валидации</li>
    <li>Функции загрузки Cargo.toml</li>
    <li>Парсер TOML-секции dependencies</li>
    <li>CLI-интерфейс на основе argparse</li>
</ol>

<hr>

<h2>Методы и функции</h2>

<ol>
    <li>validate_repo</li>
    <li>validate_output</li>
    <li>load_cargo_toml</li>
    <li>parse_dependencies</li>
    <li>parse_args</li>
    <li>main</li>
</ol>

<hr>

<h3>validate_repo</h3>

<p>
    Проверяет корректность параметра <code>--repo</code> в зависимости от режима работы.
    В режиме <code>local</code> проверяет существование файла или директории.
    В режиме <code>remote</code> валидирует URL с помощью <code>urllib.parse</code>.
</p>

<h3>validate_output</h3>

<p>
    Проверяет корректность имени выходного файла. Допускаются только расширения
    <code>.png</code>, <code>.jpg</code> и <code>.svg</code>. На данном этапе файл не создаётся, но валидация важна
    для будущих этапов визуализации.
</p>

<h3>load_cargo_toml</h3>

<p>
    Загружает содержимое файла Cargo.toml:
</p>

<ul>
    <li>в режиме <code>local</code> считывает файл из директории проекта;</li>
    <li>в режиме <code>remote</code> скачивает файл по URL.</li>
</ul>

<p>
    Проверяет существование файла и корректность загрузки.
    Возвращает содержимое файла в виде строки.
</p>

<h3>parse_dependencies</h3>

<p>
    Упрощённый парсер TOML, который извлекает секцию <code>[dependencies]</code>
    и формирует список прямых зависимостей. Обрабатывает записи вида:
</p>

<pre>
serde = "1.0"
regex = { version = "1.5", features = ["std"] }
rand = "0.8"
</pre>

<p>
    Возвращает список имён зависимостей в виде Python-списка.
</p>

<h3>parse_args</h3>

<p>
    Парсит параметры командной строки. Определяет значения параметров:
</p>

<ul>
    <li><code>--package</code></li>
    <li><code>--repo</code></li>
    <li><code>--mode</code></li>
    <li><code>--output</code></li>
    <li><code>--filter</code></li>
</ul>

<p>
    Выполняет базовую валидацию значений.
</p>

<h3>main</h3>

<p>
    Основная точка входа. Выполняет:
</p>

<ul>
    <li>валидацию параметров,</li>
    <li>загрузку Cargo.toml,</li>
    <li>извлечение зависимостей,</li>
    <li>вывод параметров запуска,</li>
    <li>вывод списка зависимостей.</li>
</ul>

<p>
    На этом этапе данные выводятся только в консоль, без визуализации.
</p>

<hr>

<h2>Особенности реализации</h2>

<p>
    Инструмент работает без использования внешних библиотек TOML-парсинга.
    Реализован минимальный разбор лишь необходимой части файла —
    секции <code>[dependencies]</code>.
</p>

<p>
    Поддержаны два источника загрузки (локальный и удалённый), что позволяет
    использовать утилиту как для локальных Rust-проектов, так и для
    репозиториев GitHub.
</p>

<p>
    Обработка ошибок реализована аккуратно: каждая ошибка выводится с
    объяснением, и программа завершается с ненулевым кодом, что удобно для
    автоматизации и тестирования.
</p>

<hr>

<h2>Команды для запуска проекта</h2>

<p>Минимальный запуск в локальном режиме:</p>

<pre>
python main.py --package dummy --repo ./test_repo --mode local --output graph.png
</pre>

<p>Запуск в удалённом режиме:</p>

<pre>
python main.py --package cargo \
               --repo https://raw.githubusercontent.com/rust-lang/cargo/master/Cargo.toml \
               --mode remote \
               --output graph.svg
</pre>

<p>
    Все параметры обязательны. Параметр <code>--filter</code> поддерживается, но
    на данном этапе не используется.
</p>

<hr>

<h2>Примеры использования</h2>

<p>Пример вывода при работе с локальным тестовым проектом:</p>

<pre>
Параметры запуска:
  package = dummy
  repo    = ./test_repo
  mode    = local
  output  = graph.png
  filter  = 

Прямые зависимости:
  - serde
  - rand
  - regex
</pre>

<p>Пример вывода при работе с удалённым проектом:</p>

<pre>
Параметры запуска:
  package = cargo
  repo    = https://raw.githubusercontent.com/rust-lang/cargo/master/Cargo.toml
  mode    = remote
  output  = graph.png
  filter  = 

Прямые зависимости:
  - clap
  - serde
  - toml
  - ... (и другие)
</pre>

<hr>
